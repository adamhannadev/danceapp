<% content_for :title, "Dance Classes" %>

<div class="page-header-ballroom">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-8">
        <h1><i class="fas fa-music me-3"></i>Dance Classes</h1>
        <p class="lead mb-0">Discover the art of ballroom dancing through our expertly crafted classes</p>
      </div>
      <div class="col-md-4 text-end">
        <%= link_to new_dance_class_path, class: "btn btn-ballroom-gold btn-lg" do %>
          <i class="fas fa-plus me-2"></i>New Class
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="container">
  <!-- Filters Section -->
  <div class="card card-ballroom mb-4 fade-in">
    <div class="card-body">
      <h5 class="card-title mb-3"><i class="fas fa-filter me-2"></i>Filter Classes</h5>
      <%= form_with url: dance_classes_path, method: :get, local: true, class: "row g-3" do |form| %>
        <div class="col-md-4">
          <%= form.label :dance_style_id, "Dance Style", class: "form-label-ballroom" %>
          <%= form.collection_select :dance_style_id, @dance_styles, :id, :name, 
                                   { prompt: "All Styles", selected: params[:dance_style_id] }, 
                                   { class: "form-select form-control-ballroom" } %>
        </div>
        <div class="col-md-4">
          <%= form.label :instructor_id, "Instructor", class: "form-label-ballroom" %>
          <%= form.collection_select :instructor_id, @instructors, :id, :full_name, 
                                   { prompt: "All Instructors", selected: params[:instructor_id] }, 
                                   { class: "form-select form-control-ballroom" } %>
        </div>
        <div class="col-md-4 d-flex align-items-end">
          <%= form.submit "Filter", class: "btn btn-ballroom-primary me-2" %>
          <%= link_to "Clear", dance_classes_path, class: "btn btn-ballroom-outline" %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Classes Grid -->
  <div class="row">
    <% @dance_classes.each_with_index do |dance_class, index| %>
      <div class="col-lg-6 col-xl-4 mb-4">
        <div class="card card-ballroom h-100 slide-in-left" style="animation-delay: <%= index * 0.1 %>s;">
          <div class="card-header card-header-ballroom d-flex justify-content-between align-items-center">
            <h5 class="mb-0"><%= dance_class.name %></h5>
            <span class="badge badge-ballroom"><%= dance_class.class_type.humanize %></span>
          </div>
          <div class="card-body">
            <!-- Dance Style & Level -->
            <div class="row mb-3">
              <div class="col-6">
                <small class="text-muted">Style</small>
                <div class="fw-bold dance-style <%= dance_class.dance_style.category.downcase.gsub(' ', '_') %>">
                  <%= dance_class.dance_style.name %>
                </div>
              </div>
              <div class="col-6">
                <small class="text-muted">Level</small>
                <div>
                  <span class="badge badge-level <%= dance_class.dance_level.name.downcase.split(' ').first %>">
                    <%= dance_class.dance_level.name %>
                  </span>
                </div>
              </div>
            </div>

            <!-- Instructor & Location -->
            <div class="row mb-3">
              <div class="col-6">
                <small class="text-muted">Instructor</small>
                <div class="fw-bold">
                  <i class="fas fa-user-graduate me-1"></i>
                  <%= dance_class.instructor.full_name %>
                </div>
              </div>
              <div class="col-6">
                <small class="text-muted">Location</small>
                <div class="fw-bold">
                  <i class="fas fa-map-marker-alt me-1"></i>
                  <%= dance_class.location.name %>
                </div>
              </div>
            </div>

            <!-- Duration & Capacity -->
            <div class="row mb-3">
              <div class="col-6">
                <small class="text-muted">Duration</small>
                <div class="fw-bold">
                  <i class="fas fa-clock me-1"></i>
                  <%= dance_class.duration_formatted %>
                </div>
              </div>
              <div class="col-6">
                <small class="text-muted">Capacity</small>
                <div class="fw-bold">
                  <i class="fas fa-users me-1"></i>
                  <%= dance_class.max_capacity %> students
                </div>
              </div>
            </div>

            <!-- Price -->
            <div class="text-center mb-3">
              <div class="price-display">
                <span class="currency">$</span><%= dance_class.price.to_i %>
                <small class="text-muted">per class</small>
              </div>
            </div>

            <!-- Description -->
            <% if dance_class.description.present? %>
              <p class="text-muted small mb-3">
                <%= truncate(dance_class.description, length: 80) %>
              </p>
            <% end %>
          </div>
          
          <div class="card-footer bg-transparent border-0">
            <div class="d-grid gap-2">
              <%= link_to dance_class_path(dance_class), class: "btn btn-ballroom-primary" do %>
                <i class="fas fa-eye me-2"></i>View Details
              <% end %>
              <div class="btn-group" role="group">
                <%= link_to edit_dance_class_path(dance_class), class: "btn btn-ballroom-outline btn-sm" do %>
                  <i class="fas fa-edit"></i>
                <% end %>
                <%= link_to dance_class_path(dance_class), method: :delete, 
                          data: { confirm: "Are you sure you want to delete this class?" }, 
                          class: "btn btn-outline-danger btn-sm" do %>
                  <i class="fas fa-trash"></i>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Empty State -->
  <% if @dance_classes.empty? %>
    <div class="text-center py-5">
      <div class="icon-ballroom mx-auto mb-3">
        <i class="fas fa-music"></i>
      </div>
      <h3 class="text-muted">No Dance Classes Found</h3>
      <p class="text-muted mb-4">Start building your dance program by creating your first class.</p>
      <%= link_to new_dance_class_path, class: "btn btn-ballroom-primary btn-lg" do %>
        <i class="fas fa-plus me-2"></i>Create Your First Class
      <% end %>
    </div>
  <% end %>

  <!-- Pagination -->
  <% if defined?(Kaminari) && @dance_classes.respond_to?(:current_page) %>
    <div class="d-flex justify-content-center mt-4">
      <%= paginate @dance_classes, outer_window: 1, inner_window: 2, left: 1, right: 1 %>
    </div>
  <% end %>
</div>

<style>
  .dance-style.american_smooth { border-left: 4px solid #8B5FBF; }
  .dance-style.american_rhythm { border-left: 4px solid #DAA520; }
  .dance-style.social { border-left: 4px solid #663399; }
  
  /* Custom Pagination Styling */
  .pagination {
    margin: 0;
  }
  
  .pagination .page-link {
    color: #8B5FBF;
    background-color: white;
    border: 1px solid #dee2e6;
    padding: 0.5rem 0.75rem;
    margin: 0 2px;
    border-radius: 6px;
    transition: all 0.3s ease;
  }
  
  .pagination .page-link:hover {
    color: white;
    background: linear-gradient(135deg, #8B5FBF 0%, #DAA520 100%);
    border-color: #8B5FBF;
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(139, 95, 191, 0.3);
  }
  
  .pagination .page-item.active .page-link {
    color: white;
    background: linear-gradient(135deg, #8B5FBF 0%, #DAA520 100%);
    border-color: #8B5FBF;
    box-shadow: 0 4px 8px rgba(139, 95, 191, 0.3);
  }
  
  .pagination .page-item.disabled .page-link {
    color: #6c757d;
    background-color: white;
    border-color: #dee2e6;
  }
</style>